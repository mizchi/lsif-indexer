# LSIF Indexer

é«˜é€Ÿãªè¨€èªéä¾å­˜ã‚³ãƒ¼ãƒ‰ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ„ãƒ¼ãƒ«ã€‚LSPãƒ™ãƒ¼ã‚¹ã®çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§è¤‡æ•°è¨€èªã«å¯¾å¿œã€‚

[![CI](https://github.com/mizchi/lsif-indexer/actions/workflows/ci.yml/badge.svg)](https://github.com/mizchi/lsif-indexer/actions/workflows/ci.yml)
[![Coverage](https://img.shields.io/badge/coverage-44%25-yellow)](https://github.com/mizchi/lsif-indexer)
[![License](https://img.shields.io/badge/license-MIT-blue)](LICENSE)

## ç‰¹å¾´

- ğŸš€ **è¶…é«˜é€Ÿ**: 1.2ç§’ã§ãƒ•ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€0.06-0.12ç§’ã§å·®åˆ†æ›´æ–°
- ğŸŒ **ãƒãƒ«ãƒè¨€èª**: Rust, Go, Python, TypeScript/JavaScriptå¯¾å¿œ
- ğŸ”Œ **LSPçµ±åˆ**: å„è¨€èªã®LSPã‚µãƒ¼ãƒãƒ¼ã¨ãƒã‚¤ãƒ†ã‚£ãƒ–çµ±åˆ
- ğŸ’¾ **åŠ¹ç‡çš„**: éšå±¤çš„ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ãƒ—ãƒ¼ãƒ«ç®¡ç†ã§é«˜é€ŸåŒ–
- ğŸ¤– **AIãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼**: ã‚·ãƒ³ãƒ—ãƒ«ãªCLIã§AIãƒ„ãƒ¼ãƒ«ã¨ã®çµ±åˆãŒå®¹æ˜“

## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

è©³ç´°ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯[docs/](./docs/)ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

- [é–‹ç™ºã‚¬ã‚¤ãƒ‰](./docs/DEVELOPMENT.md) - é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](./docs/troubleshooting.md) - ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•
- [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–](./docs/lsp-performance-optimization.md) - LSPæœ€é©åŒ–æˆ¦ç•¥
- [ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—](./docs/roadmap.md) - ä»Šå¾Œã®é–‹ç™ºè¨ˆç”»

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# Rustãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆå¿…é ˆï¼‰
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# lsif-indexerã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
cargo install --path .

# è¨€èªåˆ¥LSPã‚µãƒ¼ãƒãƒ¼ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
cargo install rust-analyzer                          # Rust
go install golang.org/x/tools/gopls@latest          # Go
pip install python-lsp-server                       # Python
npm install -g typescript-language-server typescript # TypeScript/JavaScript
```

## ä½¿ã„æ–¹

### åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
lsif index                      # è¨€èªè‡ªå‹•æ¤œå‡º
lsif index -l rust             # ç‰¹å®šè¨€èªæŒ‡å®š
lsif index --project ./src     # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæŒ‡å®š

# ã‚³ãƒ¼ãƒ‰æ¤œç´¢
lsif definition main.rs:42     # å®šç¾©ã¸ã‚¸ãƒ£ãƒ³ãƒ—
lsif references main.go:10     # å‚ç…§ã‚’æ¤œç´¢
lsif symbols                   # ã‚·ãƒ³ãƒœãƒ«ä¸€è¦§

# æ›–æ˜§æ¤œç´¢
lsif search "user" --fuzzy     # ãƒ•ã‚¡ã‚¸ãƒ¼æ¤œç´¢
lsif search "usr" --fuzzy      # éƒ¨åˆ†ä¸€è‡´

# å‹ãƒ™ãƒ¼ã‚¹æ¤œç´¢ï¼ˆæ–°æ©Ÿèƒ½ï¼‰
lsif search --returns "Result<String>"  # ç‰¹å®šã®å‹ã‚’è¿”ã™é–¢æ•°
lsif search --takes "&str"              # ç‰¹å®šã®å¼•æ•°å‹ã‚’æŒã¤é–¢æ•°
lsif search --implements "Iterator"     # ç‰¹å®štraitã®å®Ÿè£…
lsif search --has-field "Vec<u8>"       # ç‰¹å®šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‹ã‚’æŒã¤æ§‹é€ ä½“

# å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆæ–°æ©Ÿèƒ½ï¼‰
lsif def main.rs:10 --format quickfix   # Vim quickfixå½¢å¼
lsif def main.rs:10 --format lsp        # LSP Locationå½¢å¼
lsif search "test" --format json        # JSONå½¢å¼
lsif search "test" --format tsv | fzf   # TSVå½¢å¼ã§fzfã¨é€£æº

# é«˜åº¦ãªæ©Ÿèƒ½
lsif call-hierarchy main --depth 3      # ã‚³ãƒ¼ãƒ«ãƒ’ã‚¨ãƒ©ãƒ«ã‚­ãƒ¼
lsif unused                             # æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰æ¤œå‡º
lsif export --format lsif               # LSIFå½¢å¼ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
```

### ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
|----------|------|-----------|
| `--db <path>` | ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹DBã®ãƒ‘ã‚¹ | `.lsif-index.db` |
| `--project <path>` | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ | `.` |
| `--language <lang>` | è¨€èªæŒ‡å®š | è‡ªå‹•æ¤œå‡º |
| `--no-auto-index` | è‡ªå‹•ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç„¡åŠ¹åŒ– | false |
| `--format <fmt>` | å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ | human |

### å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

| ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ | èª¬æ˜ | ä½¿ç”¨ä¾‹ |
|------------|------|--------|  
| `human` | äººé–“å‘ã‘ï¼ˆçµµæ–‡å­—ä»˜ãï¼‰ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
| `quickfix` | Vim quickfixå½¢å¼ | `:cfile`ã§èª­ã¿è¾¼ã¿ |
| `lsp` | LSP Location JSON | ã‚¨ãƒ‡ã‚£ã‚¿çµ±åˆ |
| `grep` | grepäº’æ›å½¢å¼ | ä»–ãƒ„ãƒ¼ãƒ«ã¨ã®é€£æº |
| `json` | æ§‹é€ åŒ–JSON | ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ–ãƒ«å‡¦ç† |
| `tsv` | ã‚¿ãƒ–åŒºåˆ‡ã‚Š | `fzf`ã‚„`awk`ã¨ã®é€£æº |
| `null` | nullåŒºåˆ‡ã‚Š | `xargs -0`ã¨ã®é€£æº |

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„

### é«˜é€ŸåŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³

```bash
# ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚¤ãƒ³ãƒ‡ã‚¯ã‚µãƒ¼ã®ã¿ä½¿ç”¨ï¼ˆ90%é«˜é€ŸåŒ–ï¼‰
lsif index --fallback-only

# ç’°å¢ƒå¤‰æ•°ã§è¨­å®š
export LSIF_FALLBACK_ONLY=1
lsif index

# ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã§è©³ç´°è¡¨ç¤º
lsif index --progress
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

å®Ÿæ¸¬å€¤ï¼ˆè‡ªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ç´„12,000è¡Œï¼‰:

| æ“ä½œ | æ™‚é–“ | è©³ç´° |
|------|------|------|
| **ãƒ•ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹** | 0.595ç§’ | ä¸¦åˆ—å‡¦ç†ã€CPUä½¿ç”¨ç‡250% |
| **å·®åˆ†æ›´æ–°** | 0.05ç§’ | 2-3ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´ |
| **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡** | < 50MB | å…¨è¨€èªå…±é€š |
| **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚µã‚¤ã‚º** | 3.3MB | åœ§ç¸®æ¸ˆã¿ |

## ã‚µãƒãƒ¼ãƒˆè¨€èª

| è¨€èª | LSPã‚µãƒ¼ãƒãƒ¼ | ã‚µãƒãƒ¼ãƒˆæ©Ÿèƒ½ |
|------|------------|-------------|
| **Rust** | rust-analyzer | ãƒ•ãƒ«æ©Ÿèƒ½ |
| **Go** | gopls | ãƒ•ãƒ«æ©Ÿèƒ½ |
| **Python** | pylsp/pyright | ãƒ•ãƒ«æ©Ÿèƒ½ |
| **TypeScript** | typescript-language-server | ãƒ•ãƒ«æ©Ÿèƒ½ |
| **JavaScript** | typescript-language-server | ãƒ•ãƒ«æ©Ÿèƒ½ |

## ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

### LSPæ¨™æº–ã‚³ãƒãƒ³ãƒ‰

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ | LSPãƒ¡ã‚½ãƒƒãƒ‰ |
|----------|------|------------|
| `definition` | å®šç¾©ã¸ã‚¸ãƒ£ãƒ³ãƒ— | textDocument/definition |
| `references` | å‚ç…§ã‚’æ¤œç´¢ | textDocument/references |
| `symbols` | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚·ãƒ³ãƒœãƒ« | textDocument/documentSymbol |
| `workspace-symbols` | ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ¤œç´¢ | workspace/symbol |
| `call-hierarchy` | å‘¼ã³å‡ºã—éšå±¤ | textDocument/prepareCallHierarchy |
| `type-definition` | å‹å®šç¾©ã¸ | textDocument/typeDefinition |
| `implementation` | å®Ÿè£…ã‚’æ¤œç´¢ | textDocument/implementation |

### æ‹¡å¼µã‚³ãƒãƒ³ãƒ‰

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|----------|------|
| `index` | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ |
| `graph` | Cypherã‚¯ã‚¨ãƒªå®Ÿè¡Œ |
| `unused` | æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰æ¤œå‡º |
| `diff` | å¤‰æ›´å½±éŸ¿ç¯„å›²è¡¨ç¤º |
| `status` | ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹çŠ¶æ…‹ç¢ºèª |
| `export` | LSIF/JSONå½¢å¼ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ |

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLI/API   â”‚â”€â”€â”€â”€â–¶â”‚   Core      â”‚â”€â”€â”€â”€â–¶â”‚   Storage   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â–²                     â”‚
       â–¼                   â”‚                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LSP Adapter â”‚â”€â”€â”€â”€â–¶â”‚ Graph Model â”‚     â”‚   Sled DB   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Language Servers (LSP)                 â”‚
â”‚  rust-analyzer â”‚ gopls â”‚ pylsp â”‚ tsserver          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [é–‹ç™ºã‚¬ã‚¤ãƒ‰](docs/DEVELOPMENT.md) - é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„
- [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹](docs/PERFORMANCE.md) - ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã¨æœ€é©åŒ–
- [æ–°è¨€èªã‚µãƒãƒ¼ãƒˆè¿½åŠ ](docs/adding-new-language-support.md) - æ–°ã—ã„è¨€èªã®è¿½åŠ æ–¹æ³•
- [è¨€èªæ¯”è¼ƒ](docs/language-comparison.md) - å„è¨€èªã®ç‰¹æ€§ã¨å¯¾å¿œçŠ¶æ³
- [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](docs/language-agnostic-design.md) - è¨€èªéä¾å­˜è¨­è¨ˆã®è©³ç´°

## è²¢çŒ®

è²¢çŒ®ã‚’æ­“è¿ã—ã¾ã™ï¼

1. Issueã§æ©Ÿèƒ½ææ¡ˆã‚„ä¸å…·åˆå ±å‘Š
2. Pull Requestã§æ”¹å–„ã‚’ææ¡ˆ
3. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ”¹å–„

è©³ç´°ã¯[é–‹ç™ºã‚¬ã‚¤ãƒ‰](docs/DEVELOPMENT.md)ã‚’ã”è¦§ãã ã•ã„ã€‚

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License - è©³ç´°ã¯[LICENSE](LICENSE)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚